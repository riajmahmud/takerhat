<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Takerhat</title>

<style>
*
{
    box-sizing: border-box;
}

.primary
{
    max-width: 1024px;
    margin: auto;
    min-height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 5px;
}
.dynamic-shift
{
    padding: 5px;
}

.en
{
    width: 100%;
    border: 0px solid #ccc;
    position: relative;
    /*
    overflow-x: scroll;
    overflow:auto;
    white-space: nowrap;
    scrollbar-width: none;  */
}
.spacer
{
    height: 5px;
}
.day-left, .day-now, .day-right
{
    display: block;
    background-color:rgb(0, 163, 163);
    margin: 0px 0px;
    font-family: 'Segoe UI', Tahoma, Verdana, sans-serif;
    text-align: center;
    border-radius: 3px;
    position: relative;
}
.day-left, .day-right
{
    font-size: 16px;
    background-color:rgb(0, 151, 151);
    margin-top: auto;
    margin-bottom: auto;
}
.day-now
{
    font-size: 20px;
    margin: auto;
    width: 100%;

}
.month
{
    font-size: 16px;
    color: #eee;
    border-bottom: 1px solid rgba(204, 204, 204, 0.349);
    padding: 3px;
}
.date
{
    font-size: 26px;
    color: #fff;
    border-bottom: 1px solid rgba(204, 204, 204, 0.349);
    padding: 5px;
}
.fulldate
{
    font-size: 22px;
    color: rgb(82, 73, 73);
}
.stat
{
    padding: 0px;
    position: relative;
    min-height: 20px;
    text-align: left;
}


.data
{
    width: 50px;
    font-size: 22px;
}

.completion
{
    font-size: 12px;
    color: white;
    font-size: 12px;
    margin: 0px;
    margin-left: 10px;
}

.bar
{
    background:rgb(226, 211, 0);
    height: 5px;
    margin: 0px;
    border-radius: 2.5px;
}


.top-intro
{
    background-color: #eaf1f1;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
.limiter
{
    margin: auto;
    max-width: 1024px;
    border: 0px solid red;
    overflow: hidden;
}
.txt-logo
{
    letter-spacing: .5px;
    font-size: 30px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 5px;
}
.welcome
{
    margin: 20px 0px;
}
.welcome-text
{
    color: #00973a;
    text-align: center;
}
.timetables
{
    color: #00973a;
}
.time-title
{
    color: #00792e;
    border-bottom: 1px solid #ccc;
}
.segment
{
    padding-left: 5%;
    text-align: left;
}
.segment-name
{
    color: #000e05;
    font-size: 22px;
}
.segment-value
{
    color: #000e05;
    font-size: 24px;
}

.scheduler
{
    width: 100%;
}

table, tr, th, td
{
    border: 1px solid rgba(0, 0, 0, 0.246);
    border-collapse: collapse;
}
th, td
{
    text-align: left;
    padding: 5px;
    font-size: 16px;
}

.dynamic-shift
{
    display: grid;
    grid-template-columns: 100%;
    border: 1px solid #ccc;
}
.remaining
{
    border: 1px solid #ccc;
    padding: 15px;
    text-align: center;
}


.value-rem
{
    font-size: 60px;
}

.text-rem
{
    font-size: 35px;
    border-top: 1px solid #ccc;
}

@media only screen and (min-width: 480px)

{
    
}
@media only screen and (min-width: 768px)

{
        /* .day-now{ width: 60%;} */
        .dynamic-shift{ grid-template-columns: 40% 60%;}
}


</style>

</head>
<body>
    <div class="top-intro">
        <div class="limiter">
            <span class="txt-logo"><span style="color: #777;font-weight: bold;">takerhat</span><span style="color: #6caf90;">.com</span></span>
        </div>
    </div>
<!--
    Month:<input type="number" id="month" class="data" /> Day:<input type="number" id="day"  class="data" /><br>
    Hour:<input type="number" id="hour"  class="data" /> Minutes: <input type="number" id="min"  class="data" /><br>
    <button onclick="apply()" style="font-size: 24px;">Apply</button>  -->
<div class="primary">
    <div class="welcome">
        <div class="welcome-text" style="font-size:30px;"><b>Ramadan Mubarak!</b></div>
        <div class="welcome-text" style="color:#1e7d1b;">Ramadan Timetable for Takerhat and Surroundings</div>
        <div class="spacer"></div>

    </div>

<div class="dynamic-shift">
    <div class="remaining">
        <div class="value-rem" id="rem_time"></div>
        <div class="text-rem" id="rem_txt"></div>
    </div>

    <div class="dates">
        <div class="en">
            <div class="day-now">
                <div class="month" id="eng_mon"></div>
                <div class="date" id="eng_day"></div>
                <div class="stat">
                    <div class="completion" id="eng_comp"></div>
                    <div class="bar" id="eng_bar"></div>
                </div>
            </div>
        </div>
        <div class="spacer"></div>
        <div class="en" id="hijri">
            <div class="day-now">
                <div class="month" id="hijri_mon"></div>
                <div class="date" id="hijri_day"></div>
                <div class="stat">
                    <div class="completion" id="hijri_comp">35% - 3h 35min remaining</div>
                    <div class="bar" id="hijri_bar" style="width:90%;"></div>
                </div>
            </div>
        </div>
        
    </div>


</div>

    <div class="timetables">
        <h2 class="time-title">Timetables: <span class="fulldate" id="for_date"></span></h2>

        <table class="scheduler">
            <tr>
                <th>Event</th><th>Time</th><th>Status</th>
            </tr>
            <tr>
                <td>Fajr starts</td><td id="fajr_start"></td><td id="rem_fajr">-</td>
            </tr>
            <tr>
                <td>Duhr starts</td><td id="duhr_start"></td><td id="rem_duhr"></td>
            </tr>
            <tr>
                <td>Asr starts</td><td id="asr_start"></td><td id="rem_asr"></td>
            </tr>
            <tr>
                <td>Magrib starts</td><td id="magrib_start"></td><td id="rem_magrib"></td>
            </tr>
            <tr>
                <td>Isha starts</td><td id="isha_start"></td><td id="rem_isha"></td>
            </tr>
        </table>







    </div>

</div>



<script>

    //First Get Today and Now

    //Set time
    var d = new Date();
    var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    document.getElementById("eng_mon").innerHTML = months[d.getMonth()];
    document.getElementById("eng_day").innerHTML = d.getDate();
    var myObj = [null,null,null,[null,null,null,null,null,null,null,null,null,null,null,{"fajr":[4,23],"sunrise":[5,43],"duhr":[12,2],"asr":[4,32],"magrib":[6,20],"isha":[7,50]},{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,20],"sunrise":[5,39],"duhr":[12,1],"asr":[4,32],"magrib":[6,22],"isha":[7,52]},{"fajr":[4,19],"sunrise":[5,39],"duhr":[12,0],"asr":[4,32],"magrib":[6,22],"isha":[7,52]},{"fajr":[4,18],"sunrise":[5,38],"duhr":[12,0],"asr":[4,32],"magrib":[6,23],"isha":[7,53]},{"fajr":[4,17],"sunrise":[5,37],"duhr":[12,0],"asr":[4,32],"magrib":[6,23],"isha":[7,53]},{"fajr":[4,16],"sunrise":[5,36],"duhr":[12,0],"asr":[4,32],"magrib":[6,23],"isha":[7,53]},{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,23],"sunrise":[5,43],"duhr":[12,2],"asr":[4,32],"magrib":[6,20],"isha":[7,50]},{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]}],[{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,23],"sunrise":[5,43],"duhr":[12,2],"asr":[4,32],"magrib":[6,20],"isha":[7,50]},{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,23],"sunrise":[5,42],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,22],"sunrise":[5,41],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]},{"fajr":[4,21],"sunrise":[5,40],"duhr":[12,1],"asr":[4,32],"magrib":[6,21],"isha":[7,51]}]];


    var fajr = myObj[d.getMonth()][d.getDate()].fajr;
    var duhr = myObj[d.getMonth()][d.getDate()].duhr;
    var asr = myObj[d.getMonth()][d.getDate()].asr;
    var magrib = myObj[d.getMonth()][d.getDate()].magrib;
    var isha = myObj[d.getMonth()][d.getDate()].isha;

    var now = Math.round(Date.now()/1000);
    var month = d.getMonth(); var date = d.getDate();
    document.getElementById("for_date").innerHTML = "(" + date + "-" + month + "-" + "2021)";



    document.getElementById("fajr_start").innerHTML = fajr[0] + ":" + fajr[1] + "AM";
    document.getElementById("duhr_start").innerHTML = duhr[0] + ":" + duhr[1] + "PM";
    document.getElementById("asr_start").innerHTML = asr[0] + ":" + asr[1] + "PM";
    document.getElementById("magrib_start").innerHTML = magrib[0] + ":" + magrib[1] + "PM";
    document.getElementById("isha_start").innerHTML = isha[0] + ":" + isha[1] + "PM";

    //remaining


    document.getElementById("rem_fajr").innerHTML = remaining(fajr[0],fajr[1]);
    document.getElementById("rem_duhr").innerHTML = remaining(duhr[0],duhr[1]);
    document.getElementById("rem_asr").innerHTML = remaining(asr[0] + 12,asr[1]);
    document.getElementById("rem_magrib").innerHTML = remaining(magrib[0] + 12,magrib[1]);
    document.getElementById("rem_isha").innerHTML = remaining(isha[0] + 12,isha[1]);

    function remaining(h,m)
    {
        console.log("Received:" + h + ":" + m);
        var target = toTimestamp(2021,month,date,h,m,0);

        if(now<target)
        {
            var timet_diff = target - now;
            var remt_h = Math.floor(timet_diff/3600); //console.log("rem_hij_h = " + rem_hij_h);
            var remt_m = Math.round((timet_diff/3600 - Math.floor(timet_diff/3600))*60); //console.log("rem_hij_m = " + rem_hij_m);
            var rtn_txt ="";
            console.log(remt_h,remt_m);
            if(remt_h!=0){rtn_txt += remt_h + "h ";}
            if(remt_m!=0){rtn_txt += remt_m + "m";}

        }
        else
        {
            var rtn_txt ="--";
        }


        return rtn_txt;
    }
    
    //console.log("Month: " + parseInt(d.getMonth()+1) + " Day: " + d.getDate() + "  Fajr At: " + fajr[0] + ":" + fajr[1]);


    //compare timestamp
    //Timestamp of magrib today
    //var month = d.getMonth(); var date = d.getDate();
    var time_magrib_today = toTimestamp(2021,month,date,magrib[0]+12,magrib[1],0);
    console.log("supplied: 2021," +  month + "-" + date + "  " + magrib[0] + ":" + magrib[1] + ":00" )
    console.log("Magrib timestamp: " + time_magrib_today + " . Timestamp Now: " + now);
    
function toTimestamp(year,month,day,hour,minute,second){
     var datum = new Date(Date.UTC(year,month,day,hour,minute,second));
     return datum.getTime()/1000 - 21600;
    }

    //if time_now is less than magrib_timestamp
        if(now<time_magrib_today)
        {
            if(month==3){var ramadan_no = date - 13;}else if(month==4){var ramadan_no = date+17;}
        }
        else{
            if(month==3){var ramadan_no = date - 12;}else if(month==4){var ramadan_no = date+18;}
        }

        console.log(ramadan_no);

        //Submit Ramadan Day
    document.getElementById("hijri_mon").innerHTML = "Ramadan";
    document.getElementById("hijri_day").innerHTML = ramadan_no;

    // Percentage Completed English
    var percentage_eng = parseFloat(d.getHours()*60 + d.getMinutes())/14.4;
    var rem_eng_h = Math.floor(((100-percentage_eng)*14.4)/60);
    var rem_eng_m =Math.round((((100-percentage_eng)*14.4)/60 - Math.floor(((100-percentage_eng)*14.4)/60))*60);
    var rem_eng_text = Math.round(percentage_eng) + "%  -  ";
    if(rem_eng_h!=0){rem_eng_text += rem_eng_h + "h ";}
    if(rem_eng_m!=0){rem_eng_text += rem_eng_m + "m";}
    rem_eng_text += " remaining";
    document.getElementById("eng_comp").innerHTML = rem_eng_text;
    //bar update
    document.getElementById("eng_bar").style.width = percentage_eng + "%";
    console.log(percentage_eng + "  " + d.getHours() + ":" + d.getMinutes());

    ////Percentage completed Hijri
    if(now<time_magrib_today)
    {
        var time_diff = time_magrib_today - now; console.log("time_diff = " + time_diff);
        var rem_hij_h = Math.floor(time_diff/3600); console.log("rem_hij_h = " + rem_hij_h);
        var rem_hij_m = Math.round((time_diff/3600 - Math.floor(time_diff/3600))*60); console.log("rem_hij_m = " + rem_hij_m);
        var percentage_hij = (86400-time_diff)/864;  console.log("percentage_hij = " + percentage_hij);
    }
    else
    {
        var time_diff = now - time_magrib_today;
        var rem_hij_h = Math.floor((86400-time_diff)/3600);
        var rem_hij_m = Math.round(((86400-time_diff)/3600 - Math.floor((86400-time_diff)/3600))*60);
        var percentage_hij = (time_diff)/864;
    }

    var rem_hij_text = Math.round(percentage_hij) + "%  -  ";
    if(rem_hij_h!=0){rem_hij_text += rem_hij_h + "h ";}
    if(rem_hij_m!=0){rem_hij_text += rem_hij_m + "m";}
    rem_hij_text += " remaining";
    document.getElementById("hijri_comp").innerHTML = rem_hij_text;
    //bar update
    document.getElementById("hijri_bar").style.width = percentage_hij + "%";

    console.log(percentage_hij + "  " + d.getHours() + ":" + d.getMinutes());


    //Set remaining time for Sahri
        //fajr[0],fajr[1]
    var time_fajr_today = toTimestamp(2021,month,date,fajr[0],fajr[1],0);
    if(now<time_fajr_today)
    {
        var time_diff_next = time_fajr_today - now;
        var rem_txt = "for Sahri";
    }
    else if(now<time_magrib_today)
    {
        var time_diff_next = time_magrib_today - now;
        var rem_txt = "for Iftaar";
    }
    else
    {
        var today = new Date();
        var tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow_month = romorrow.getMonth();
        tomorrow_date = tomorrow.getDate();
        var fajr_n = myObj[tomorrow_month][tomorrow_date].fajr;
        var time_sahri_tomorrow = toTimestamp(2021,tomorrow_month,tomorrow_date,fajr_n[0],fajr_n[1],0);
        var time_diff_next = time_sahri_tomorrow - now - 300;  //Precautionary 300 Seconds
        var rem_txt = "for Sahri";
    }

    var rem_h = Math.floor(time_diff/3600); //console.log("rem_hij_h = " + rem_hij_h);
    var rem_m = Math.round((time_diff/3600 - Math.floor(time_diff/3600))*60); //console.log("rem_hij_m = " + rem_hij_m);

    var rem_time ="";
    if(rem_h!=0){rem_time += rem_h + "h ";}
    if(rem_m!=0){rem_time += rem_m + "m";}
    //submit
    document.getElementById("rem_time").innerHTML = rem_time;
    document.getElementById("rem_txt").innerHTML = rem_txt;




</script>

</body>
</html>
